<!DOCTYPE html>
<html>
<script src="https://aframe.io/releases/1.0.0/aframe.min.js"></script>
<!-- we import arjs version without NFT but with marker + location based support -->
<script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

<body style="margin : 0px; overflow: hidden;">
  <a-scene embedded arjs renderer="logarithmicDepthBuffer: true;" vr-mode-ui="enabled: false" gesture-detector
    id="scene">
    <a-marker type="pattern" preset="custom" url="./model/pattern-qr-code.patt">
      <a-entity position="0 -1 0" scale="0.05 0.05 0.05"
        gltf-model="https://arjs-cors-proxy.herokuapp.com/https://raw.githack.com/AR-js-org/AR.js/master/aframe/examples/image-tracking/nft/trex/scene.gltf">
      </a-entity>
    </a-marker>
    <a-entity camera></a-entity>
  </a-scene>
</body>

<script>
  var isMarkerVisible = false;

  function initAScen() {
    let sceneEl = document.querySelector('#scene');
    sceneEl.addEventListener("onefingermove", handleRotation);
    sceneEl.addEventListener("twofingermove", handleScale);
    sceneEl.addEventListener("markerFound", (e) => {
      isMarkerVisible = true;
    });

    sceneEl.addEventListener("markerLost", (e) => {
      isMarkerVisible = false;
    });
  }

  function handleRotation(event) {
    console.log('onefinger');

    if (isMarkerVisible) {
      el.object3D.rotation.y +=
        event.detail.positionChange.x * rotationFactor;

      el.object3D.rotation.x +=
        event.detail.positionChange.y * rotationFactor;
    }
  }

  function handleScale(event) {
    console.log('twofinger');
    if (isMarkerVisible) {
      this.scaleFactor *=
        1 + event.detail.spreadChange / event.detail.startSpread;

      this.scaleFactor = Math.min(
        Math.max(this.scaleFactor, this.data.minScale),
        this.data.maxScale
      );

      el.object3D.scale.x = scaleFactor * initialScale.x;
      el.object3D.scale.y = scaleFactor * initialScale.y;
      el.object3D.scale.z = scaleFactor * initialScale.z;
    }
  }
  initAScen();
</script>

</html>